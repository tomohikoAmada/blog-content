---
title: "TWS API 各项设置含义"
date: 2025-12-31
category: "量化交易"
tags: []
draft: false
---

# TWS API 各项设置含义

* 启用ActiveX和Socket客户端
<br>
    这是启用API连接的必要设置，允许通过Socket（如Java、C++、Python）或ActiveX连接到TWS
    * **必须勾选**才能使用API
    * Socket是最常用的连接方式
* 只读API (Read-Only API)
<br>
    默认启用，会阻止所有API订单。当只读模式启用时，订单信息对API不可用
<br>
    如果勾选：只能查询数据，不能下单
* TotalQuantity与段位于用于传输共同基金价值...
<br>
    这个设置与共同基金订单的数量计算相关。一般保持默认即可
* 仅接收下载未完成交委单
    * 勾选：只下载未完成的订单
    * 不勾选：下载所有订单包括已完成的
    * 建议勾选
* 使这设资组合时包括虚拟外汇订仓
<br>
    如果启用了Include FX Positions功能，当投资组合更新发送给API客户端时，所有外汇持仓都会被包含。一般保持默认
    * 是否包含外汇持仓信息
* 下载包含的准备当日数次到DailyPnL
<br>
    连接时是否自动下载当日盈亏信息。建议勾选，方便监控
* Send status updates for Volatility orders...
<br>
    如果为波动率订单激活了持续更新，所有更新会默认发送给API客户端。针对特定订单类型的状态更新，一般保持默认
* 以英文发送API消息
<br>
    API消息使用英文还是本地语言，**建议勾选英文**（便于程序解析）
* 添加API端口、产品名称：ASCII 7 (Python、Java、.NET)
<br>
    API使用的通信协议版本
    * ASCII 7 (Python, Java, .NET) - 标准Socket协议，是最常用的协议，用于Python、Java、C#、Go、R等语言
    * 保持系统状态的页面 (C++) - C++ API专用，只用于使用C++ TWS API的程序
* 套接字端口：7496
<br>
    默认情况下，生产账户TWS会设置为端口7496，模拟账户会监听端口7497
    * Live账户：7496
    * Paper账户：7497
* 使用信息数据和捆绑自动委托单
<br>
    连接时自动下载并处理订单，
    * 建议勾选
* 创建API消息日志文件
    * 强烈建议勾选用于调试
    * 日志文件位置通常在 `~/Jts/` 目录
* 在API日志文件中包含市场数据
    * 是否在日志中记录市场数据
    * 调试时有用，生产环境可以关闭（减少日志大小）
* 向API公开全个易时间可选
<br>
    是否允许API访问完整的交易时间信息，
    * 建议勾选
* 从现有系统中删离高保持续
<br>
    这个选项与系统保护机制相关。
    * 一般保持默认
* 仅对当头实际的来自合发送证券
<br>
    这个选项控制向API发送哪些持仓信息。
    * 一般保持默认
* 登录级别：Error
<br>
    日志记录级别。Error: 只记录错误。建议选择更详细的级别（如Info或Debug）用于调试
* 主API客户ID
<br>
    要指定某个客户端自动接收所有未结订单的更新，以及所有客户端下单的佣金报告，应该在TWS或IBGW全局配置中设置该客户端的ID为Master Client ID
<br>
    **重要设置！**
<br>
    如果设置为某个ID（如0），该客户端会：
    * 接收所有订单状态更新
    * 可以管理其他客户端的订单
    * 接收佣金报告

    **建议设置为0**（如果你只有一个API程序）
* 向API发送批量数据超时时间：30
<br>
    API数据发送的超时时间（秒）。30秒是合理值，网络差可以增加
* 成分交易所分隔符
<br>
    多个交易所之间的分隔符。
    * 一般不需要修改
* 容忍客户错误至最近的整数
<br>
    处理小数点精度问题。建议勾选
* 以英国主键为加密模式API连接已送达到此场地现场码
<br>
    与消息发送优先级相关。一般保持默认
* 对每次跟踪或最特征推进已在任何
<br>
    这个选项与订单追踪相关。
    * 一般保持默认
* Reject messages above maximum allowed message rate
<br>
    防止消息发送速率过高。
    * 建议勾选（保护机制）
* 收到错误返信后的域时保持连接
<br>
    TWS会等待一段时间后再断开API客户端连接，如果数据发送不够快。**建议勾选**，避免临时错误导致断线
* 兼容模式：为在纳斯达克选出交易的美国发送到ISLAND
<br>
    路由设置，一般不需要改
* Download execution reports: 今天
<br>
    下载哪些时间范围的执行报告。**今天**是合理选择
* 将历史想取分为以下天为单位的部分：16
<br>
    历史数据分段大小。默认值即可
* 自动取消委相应算符合约的交易
<br>
    当连接断开时，自动取消活跃订单。安全功能，建议勾选
* 重置API套托单号码序列
<br>
    重置订单ID序列。一般不需要使用
* 仅允许从本地机主机连接
<br>
    这是重要的安全设置，只允许来自同一台计算机的连接。否则需要添加受信任的IP地址
* 受信任IP
<br>
    如果通过受信任的IP地址连接API，连接不会被质疑。否则你会收到验证消息询问是否确定要建立连接
    * 如果取消了"仅本地连接"，必须添加允许连接的IP
    * 格式：
        * 单个IP：`192.168.1.100`
        * IP段：`192.168.1.0/24`
        * 多个IP：逗号分隔

![1767184627761-image-20251231203554806.png](/api/getImage?path=1767184627761-image-20251231203554806.png)